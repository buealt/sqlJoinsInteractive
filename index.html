<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL JOIN Tutorial</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/sql-wasm.js"></script>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; padding: 20px; max-width: 800px; margin: 0 auto; }
        h1, h2 { color: #333; }
        pre { background-color: #f4f4f4; padding: 10px; border-radius: 5px; overflow-x: auto; }
        .sql-input { width: 100%; height: 100px; margin-bottom: 10px; }
        .execute-btn { padding: 10px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        .result { margin-top: 20px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <h1>SQL JOIN Tutorial</h1>
    
    <h2>Einführung</h2>
    <p>MySQL bietet verschiedene Arten von Joins. Joins kombinieren Daten aus mehreren Tabellen basierend auf einer gemeinsamen Spalte. Die Wahl des Joins hängt von der spezifischen Beziehung und den Anforderungen der Abfrage ab.</p>
    
    <h2>Join-Arten</h2>
    <ul>
        <li>INNER JOIN</li>
        <li>LEFT JOIN (oder LEFT OUTER JOIN)</li>
        <li>RIGHT JOIN (oder RIGHT OUTER JOIN)</li>
        <li>FULL JOIN (oder FULL OUTER JOIN)</li>
        <li>CROSS JOIN</li>
        <li>SELF JOIN</li>
    </ul>
    
    <h2>Beispieldaten</h2>
    <p>Für dieses Tutorial verwenden wir zwei Tabellen: 'Kunden' und 'Bestellungen'.</p>
    
    <h3>Kunden-Tabelle</h3>
    <pre>
CREATE TABLE Kunden (
    KundenID INTEGER PRIMARY KEY,
    Name TEXT,
    Stadt TEXT
);

INSERT INTO Kunden (KundenID, Name, Stadt) VALUES 
    (1, 'Max Mustermann', 'Berlin'),
    (2, 'Erika Musterfrau', 'Hamburg'),
    (3, 'Hans Meier', 'München'),
    (4, 'Anna Schmidt', 'Köln'),
    (5, 'Peter Müller', 'Frankfurt'),
    (6, 'Julia Fischer', 'Stuttgart');
    </pre>
    
    <h3>Bestellungen-Tabelle</h3>
    <pre>
CREATE TABLE Bestellungen (
    BestellID INTEGER PRIMARY KEY,
    KundenID INTEGER,
    Produkt TEXT,
    Menge INTEGER
);

INSERT INTO Bestellungen (BestellID, KundenID, Produkt, Menge) VALUES 
    (1, 1, 'Laptop', 2),
    (2, 2, 'Smartphone', 1),
    (3, 3, 'Tablet', 3),
    (4, 1, 'Monitor', 1),
    (5, 4, 'Drucker', 2),
    (6, 5, 'Kopfhörer', 4),
    (7, 6, 'Maus', 5);
    </pre>
    
    <h2>INNER JOIN Beispiel</h2>
    <p>Ein INNER JOIN gibt nur die Zeilen zurück, die in beiden Tabellen übereinstimmende Werte haben.</p>
    <textarea class="sql-input" id="innerJoinInput">
SELECT Kunden.Name, Bestellungen.Produkt
FROM Kunden
INNER JOIN Bestellungen ON Kunden.KundenID = Bestellungen.KundenID;
    </textarea>
    <button class="execute-btn" onclick="executeQuery('innerJoinInput', 'innerJoinResult')">Ausführen</button>
    <div id="innerJoinResult" class="result"></div>
    
    <h2>LEFT JOIN Beispiel</h2>
    <p>Ein LEFT JOIN gibt alle Zeilen aus der linken Tabelle und die übereinstimmenden Zeilen aus der rechten Tabelle zurück.</p>
    <textarea class="sql-input" id="leftJoinInput">
SELECT Kunden.Name, Bestellungen.Produkt
FROM Kunden
LEFT JOIN Bestellungen ON Kunden.KundenID = Bestellungen.KundenID;
    </textarea>
    <button class="execute-btn" onclick="executeQuery('leftJoinInput', 'leftJoinResult')">Ausführen</button>
    <div id="leftJoinResult" class="result"></div>

<!--     <h2>RIGHT JOIN Beispiel</h2>
    <p>Ein RIGHT JOIN gibt alle Zeilen aus der rechten Tabelle und die übereinstimmenden Zeilen aus der linken Tabelle zurück.</p>
    <textarea class="sql-input" id="rightJoinInput">
SELECT Kunden.Name, Bestellungen.Produkt
FROM Kunden
RIGHT JOIN Bestellungen ON Kunden.KundenID = Bestellungen.KundenID;
    </textarea>
    <button class="execute-btn" onclick="executeQuery('rightJoinInput', 'rightJoinResult')">Ausführen</button>
    <div id="rightJoinResult" class="result"></div>

    <h2>FULL JOIN Beispiel (simuliert)</h2>
    <p>Ein FULL JOIN gibt alle Zeilen zurück, wenn es eine Übereinstimmung in einer der Tabellen gibt. Da MySQL FULL JOIN nicht direkt unterstützt, kann dies durch UNION von LEFT JOIN und RIGHT JOIN simuliert werden.</p>
    <textarea class="sql-input" id="fullJoinInput">
SELECT Kunden.Name, Bestellungen.Produkt
FROM Kunden
LEFT JOIN Bestellungen ON Kunden.KundenID = Bestellungen.KundenID
UNION
SELECT Kunden.Name, Bestellungen.Produkt
FROM Kunden
RIGHT JOIN Bestellungen ON Kunden.KundenID = Bestellungen.KundenID;
    </textarea>
    <button class="execute-btn" onclick="executeQuery('fullJoinInput', 'fullJoinResult')">Ausführen</button>
    <div id="fullJoinResult" class="result"></div> -->

    <h2>CROSS JOIN Beispiel</h2>
    <p>Ein CROSS JOIN gibt das kartesische Produkt der beiden Tabellen zurück. Jede Zeile der ersten Tabelle wird mit jeder Zeile der zweiten Tabelle kombiniert.</p>
    <textarea class="sql-input" id="crossJoinInput">
SELECT Kunden.Name, Bestellungen.Produkt
FROM Kunden
CROSS JOIN Bestellungen;
    </textarea>
    <button class="execute-btn" onclick="executeQuery('crossJoinInput', 'crossJoinResult')">Ausführen</button>
    <div id="crossJoinResult" class="result"></div>

    <h2>SELF JOIN Beispiel</h2>
    <p>Ein SELF JOIN verknüpft eine Tabelle mit sich selbst. Dies wird verwendet, um Hierarchien oder rekursive Strukturen zu analysieren.</p>
    <textarea class="sql-input" id="selfJoinInput">
SELECT a.Name AS Parent, b.Name AS Child
FROM Kunden a, Kunden b
WHERE a.KundenID = b.KundenID;
    </textarea>
    <button class="execute-btn" onclick="executeQuery('selfJoinInput', 'selfJoinResult')">Ausführen</button>
    <div id="selfJoinResult" class="result"></div>

    <script>
        let db;
        let initPromise = initSqlJs({ locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.6.2/${file}` });
    
        initPromise.then(function(SQL){
            db = new SQL.Database();
            db.run(`
                CREATE TABLE Kunden (
                    KundenID INTEGER PRIMARY KEY,
                    Name TEXT,
                    Stadt TEXT
                );
                INSERT INTO Kunden (KundenID, Name, Stadt) VALUES 
                    (1, 'Max Mustermann', 'Berlin'),
                    (2, 'Erika Musterfrau', 'Hamburg'),
                    (3, 'Hans Meier', 'München'),
                    (4, 'Anna Schmidt', 'Köln'),
                    (5, 'Peter Müller', 'Frankfurt'),
                    (6, 'Julia Fischer', 'Stuttgart');
            `);
            db.run(`
                CREATE TABLE Bestellungen (
                    BestellID INTEGER PRIMARY KEY,
                    KundenID INTEGER,
                    Produkt TEXT,
                    Menge INTEGER
                );
                INSERT INTO Bestellungen (BestellID, KundenID, Produkt, Menge) VALUES 
                    (1, 1, 'Laptop', 2),
                    (2, 2, 'Smartphone', 1),
                    (3, 3, 'Tablet', 3),
                    (4, 1, 'Monitor', 1),
                    (5, 4, 'Drucker', 2),
                    (6, 5, 'Kopfhörer', 4),
                    (7, 6, 'Maus', 5);
            `);
        });
    
        function executeQuery(inputId, resultId) {
            initPromise.then(() => {
                const sqlQuery = document.getElementById(inputId).value;
                try {
                    const result = db.exec(sqlQuery);
                    displayResult(result, resultId);
                } catch (err) {
                    document.getElementById(resultId).innerHTML = 'Fehler: ' + err.message;
                }
            });
        }
    
        function displayResult(result, resultId) {
            if (result.length === 0) {
                document.getElementById(resultId).innerHTML = 'Keine Ergebnisse.';
                return;
            }
            
            let tableHtml = '<table><tr>';
            result[0].columns.forEach(column => {
                tableHtml += `<th>${column}</th>`;
            });
            tableHtml += '</tr>';
            
            result[0].values.forEach(row => {
                tableHtml += '<tr>';
                row.forEach(cell => {
                    tableHtml += `<td>${cell}</td>`;
                });
                tableHtml += '</tr>';
            });
            tableHtml += '</table>';
            
            document.getElementById(resultId).innerHTML = tableHtml;
        }
    </script>
</body>
</html>
